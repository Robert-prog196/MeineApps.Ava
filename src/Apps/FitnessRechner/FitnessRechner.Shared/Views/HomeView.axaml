<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:FitnessRechner.ViewModels"
             xmlns:mi="using:Material.Icons.Avalonia"
             xmlns:loc="using:MeineApps.Core.Ava.Localization"
             x:Class="FitnessRechner.Views.HomeView"
             x:DataType="vm:MainViewModel">

  <ScrollViewer Padding="0,0,0,100">
    <StackPanel Spacing="0">

      <!-- ========== Hero-Header (Green/Teal Gradient) ========== -->
      <Border CornerRadius="0,0,16,16" Padding="20,20,20,16">
        <Border.Background>
          <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
            <GradientStop Color="#22C55E" Offset="0" />
            <GradientStop Color="{DynamicResource SecondaryColor}" Offset="0.5" />
            <GradientStop Color="{DynamicResource AccentColor}" Offset="1" />
          </LinearGradientBrush>
        </Border.Background>
        <StackPanel Spacing="8" HorizontalAlignment="Center">
          <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
            <Border Width="36" Height="36" CornerRadius="18" Background="#33FFFFFF">
              <mi:MaterialIcon Kind="HeartPulse" Width="20" Height="20"
                               Foreground="White"
                               HorizontalAlignment="Center" VerticalAlignment="Center" />
            </Border>
            <StackPanel VerticalAlignment="Center">
              <TextBlock Text="{Binding GreetingText}"
                         FontSize="13" Foreground="#CCFFFFFF" />
              <TextBlock Text="{loc:Translate AppName}"
                         FontSize="20" FontWeight="Bold" Foreground="White" />
            </StackPanel>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- ========== Content ========== -->
      <StackPanel Spacing="16" Margin="12,16,12,0">

        <!-- ========== Today Dashboard Card ========== -->
        <Border Classes="Card" Padding="16"
                BoxShadow="{DynamicResource CardShadow}"
                IsVisible="{Binding HasDashboardData}">
          <StackPanel Spacing="12">
            <StackPanel Orientation="Horizontal" Spacing="8">
              <mi:MaterialIcon Kind="CalendarToday" Width="20" Height="20"
                               Foreground="{DynamicResource PrimaryBrush}" />
              <TextBlock Text="{loc:Translate TodayDashboard}"
                         FontSize="16" FontWeight="Bold"
                         Foreground="{DynamicResource TextPrimaryBrush}"
                         VerticalAlignment="Center" />
            </StackPanel>

            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="12" RowSpacing="12">

              <!-- Gewicht -->
              <Border Grid.Row="0" Grid.Column="0"
                      Background="{DynamicResource SurfaceBrush}"
                      CornerRadius="10" Padding="12">
                <StackPanel Spacing="6" HorizontalAlignment="Center">
                  <Border CornerRadius="10" Width="40" Height="40" HorizontalAlignment="Center">
                    <Border.Background>
                      <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                        <GradientStop Color="#8B5CF6" Offset="0" />
                        <GradientStop Color="#7C3AED" Offset="1" />
                      </LinearGradientBrush>
                    </Border.Background>
                    <mi:MaterialIcon Kind="ScaleBathroom" Width="20" Height="20"
                                     Foreground="White"
                                     HorizontalAlignment="Center" VerticalAlignment="Center" />
                  </Border>
                  <StackPanel Orientation="Horizontal" Spacing="4" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding TodayWeightDisplay}"
                               FontSize="18" FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimaryBrush}" />
                    <TextBlock Text="kg" FontSize="12"
                               Foreground="{DynamicResource TextMutedBrush}"
                               VerticalAlignment="Bottom" Margin="0,0,0,2" />
                  </StackPanel>
                </StackPanel>
              </Border>

              <!-- BMI -->
              <Border Grid.Row="0" Grid.Column="1"
                      Background="{DynamicResource SurfaceBrush}"
                      CornerRadius="10" Padding="12">
                <StackPanel Spacing="6" HorizontalAlignment="Center">
                  <Border CornerRadius="10" Width="40" Height="40" HorizontalAlignment="Center">
                    <Border.Background>
                      <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                        <GradientStop Color="#3B82F6" Offset="0" />
                        <GradientStop Color="#2563EB" Offset="1" />
                      </LinearGradientBrush>
                    </Border.Background>
                    <mi:MaterialIcon Kind="ScaleBalance" Width="20" Height="20"
                                     Foreground="White"
                                     HorizontalAlignment="Center" VerticalAlignment="Center" />
                  </Border>
                  <StackPanel Orientation="Horizontal" Spacing="4" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding TodayBmiDisplay}"
                               FontSize="18" FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimaryBrush}" />
                    <TextBlock Text="BMI" FontSize="12"
                               Foreground="{DynamicResource TextMutedBrush}"
                               VerticalAlignment="Bottom" Margin="0,0,0,2" />
                  </StackPanel>
                </StackPanel>
              </Border>

              <!-- Wasser -->
              <Border Grid.Row="1" Grid.Column="0"
                      Background="{DynamicResource SurfaceBrush}"
                      CornerRadius="10" Padding="12">
                <StackPanel Spacing="6" HorizontalAlignment="Center">
                  <Border CornerRadius="10" Width="40" Height="40" HorizontalAlignment="Center">
                    <Border.Background>
                      <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                        <GradientStop Color="#22C55E" Offset="0" />
                        <GradientStop Color="#16A34A" Offset="1" />
                      </LinearGradientBrush>
                    </Border.Background>
                    <mi:MaterialIcon Kind="Water" Width="20" Height="20"
                                     Foreground="White"
                                     HorizontalAlignment="Center" VerticalAlignment="Center" />
                  </Border>
                  <StackPanel Orientation="Horizontal" Spacing="4" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding TodayWaterDisplay}"
                               FontSize="18" FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimaryBrush}" />
                  </StackPanel>
                  <!-- Wasser-Fortschrittsbalken -->
                  <ProgressBar Value="{Binding WaterProgress}" Maximum="100"
                               Height="4" CornerRadius="2" Margin="4,2,4,0"
                               Foreground="#22C55E" />
                </StackPanel>
              </Border>

              <!-- Kalorien -->
              <Border Grid.Row="1" Grid.Column="1"
                      Background="{DynamicResource SurfaceBrush}"
                      CornerRadius="10" Padding="12">
                <StackPanel Spacing="6" HorizontalAlignment="Center">
                  <Border CornerRadius="10" Width="40" Height="40" HorizontalAlignment="Center">
                    <Border.Background>
                      <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                        <GradientStop Color="#F59E0B" Offset="0" />
                        <GradientStop Color="#D97706" Offset="1" />
                      </LinearGradientBrush>
                    </Border.Background>
                    <mi:MaterialIcon Kind="Fire" Width="20" Height="20"
                                     Foreground="White"
                                     HorizontalAlignment="Center" VerticalAlignment="Center" />
                  </Border>
                  <StackPanel Orientation="Horizontal" Spacing="4" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding TodayCaloriesDisplay}"
                               FontSize="18" FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimaryBrush}" />
                    <TextBlock Text="kcal" FontSize="12"
                               Foreground="{DynamicResource TextMutedBrush}"
                               VerticalAlignment="Bottom" Margin="0,0,0,2" />
                  </StackPanel>
                  <!-- Kalorien-Fortschrittsbalken -->
                  <ProgressBar Value="{Binding CalorieProgress}" Maximum="100"
                               Height="4" CornerRadius="2" Margin="4,2,4,0"
                               Foreground="#F59E0B" />
                </StackPanel>
              </Border>

            </Grid>
          </StackPanel>
        </Border>

        <!-- ========== Streak Card ========== -->
        <Border Classes="Card" Padding="14" BoxShadow="{DynamicResource CardShadow}">
          <Grid ColumnDefinitions="Auto,*,Auto">
            <!-- Flammen-Icon mit Gradient -->
            <Border Grid.Column="0" Width="44" Height="44" CornerRadius="12" Margin="0,0,12,0">
              <Border.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                  <GradientStop Color="#F59E0B" Offset="0" />
                  <GradientStop Color="#EF4444" Offset="1" />
                </LinearGradientBrush>
              </Border.Background>
              <mi:MaterialIcon Kind="Fire" Width="24" Height="24"
                               Foreground="White"
                               HorizontalAlignment="Center" VerticalAlignment="Center" />
            </Border>
            <!-- Streak-Text -->
            <StackPanel Grid.Column="1" VerticalAlignment="Center" Spacing="2">
              <TextBlock Text="{Binding StreakTitleText}"
                         FontSize="13" Foreground="{DynamicResource TextMutedBrush}" />
              <TextBlock Text="{Binding StreakDisplay}"
                         FontSize="18" FontWeight="Bold"
                         Foreground="{DynamicResource TextPrimaryBrush}" />
            </StackPanel>
            <!-- Best-Streak Badge -->
            <Border Grid.Column="2" VerticalAlignment="Center"
                    Background="{DynamicResource SurfaceBrush}"
                    CornerRadius="8" Padding="8,4"
                    IsVisible="{Binding HasStreak}">
              <TextBlock Text="{Binding StreakBestDisplay}"
                         FontSize="11" Foreground="{DynamicResource TextMutedBrush}" />
            </Border>
          </Grid>
        </Border>

        <!-- ========== Calculators Section ========== -->
        <StackPanel Spacing="12">
          <StackPanel Orientation="Horizontal" Spacing="8">
            <Border Background="{DynamicResource PrimaryBrush}"
                    CornerRadius="6" Padding="8,4">
              <TextBlock Text="{Binding SectionCalculatorsText}" FontSize="11" FontWeight="Bold" Foreground="White" />
            </Border>
            <TextBlock Text="{loc:Translate MyCalculators}"
                       FontSize="18" FontWeight="Bold"
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>

          <!-- Calculator Grid (2 Spalten) -->
          <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto" ColumnSpacing="12" RowSpacing="12">

            <!-- BMI -->
            <Button Grid.Row="0" Grid.Column="0"
                    CornerRadius="12" Height="120" Padding="8"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                    Command="{Binding OpenBmiCommand}">
              <Button.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                  <GradientStop Color="{DynamicResource CardColor}" Offset="0" />
                  <GradientStop Color="{DynamicResource CardHoverColor}" Offset="1" />
                </LinearGradientBrush>
              </Button.Background>
              <StackPanel VerticalAlignment="Center" Spacing="8">
                <Border CornerRadius="12" Width="48" Height="48" HorizontalAlignment="Center">
                  <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                      <GradientStop Color="#3B82F6" Offset="0" />
                      <GradientStop Color="#2563EB" Offset="1" />
                    </LinearGradientBrush>
                  </Border.Background>
                  <mi:MaterialIcon Kind="ScaleBalance" Width="24" Height="24"
                                   Foreground="White"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <TextBlock Text="{loc:Translate CalcBmi}"
                           FontSize="13" FontWeight="Bold" TextAlignment="Center"
                           Foreground="{DynamicResource TextPrimaryBrush}" />
              </StackPanel>
            </Button>

            <!-- Kalorien -->
            <Button Grid.Row="0" Grid.Column="1"
                    CornerRadius="12" Height="120" Padding="8"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                    Command="{Binding OpenCaloriesCommand}">
              <Button.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                  <GradientStop Color="{DynamicResource CardColor}" Offset="0" />
                  <GradientStop Color="{DynamicResource CardHoverColor}" Offset="1" />
                </LinearGradientBrush>
              </Button.Background>
              <StackPanel VerticalAlignment="Center" Spacing="8">
                <Border CornerRadius="12" Width="48" Height="48" HorizontalAlignment="Center">
                  <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                      <GradientStop Color="#F59E0B" Offset="0" />
                      <GradientStop Color="#D97706" Offset="1" />
                    </LinearGradientBrush>
                  </Border.Background>
                  <mi:MaterialIcon Kind="Fire" Width="24" Height="24"
                                   Foreground="White"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <TextBlock Text="{loc:Translate CalcCalories}"
                           FontSize="13" FontWeight="Bold" TextAlignment="Center"
                           Foreground="{DynamicResource TextPrimaryBrush}" />
              </StackPanel>
            </Button>

            <!-- Wasser -->
            <Button Grid.Row="1" Grid.Column="0"
                    CornerRadius="12" Height="120" Padding="8"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                    Command="{Binding OpenWaterCommand}">
              <Button.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                  <GradientStop Color="{DynamicResource CardColor}" Offset="0" />
                  <GradientStop Color="{DynamicResource CardHoverColor}" Offset="1" />
                </LinearGradientBrush>
              </Button.Background>
              <StackPanel VerticalAlignment="Center" Spacing="8">
                <Border CornerRadius="12" Width="48" Height="48" HorizontalAlignment="Center">
                  <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                      <GradientStop Color="#22C55E" Offset="0" />
                      <GradientStop Color="#16A34A" Offset="1" />
                    </LinearGradientBrush>
                  </Border.Background>
                  <mi:MaterialIcon Kind="Water" Width="24" Height="24"
                                   Foreground="White"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <TextBlock Text="{loc:Translate CalcWater}"
                           FontSize="13" FontWeight="Bold" TextAlignment="Center"
                           Foreground="{DynamicResource TextPrimaryBrush}" />
              </StackPanel>
            </Button>

            <!-- Idealgewicht -->
            <Button Grid.Row="1" Grid.Column="1"
                    CornerRadius="12" Height="120" Padding="8"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                    Command="{Binding OpenIdealWeightCommand}">
              <Button.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                  <GradientStop Color="{DynamicResource CardColor}" Offset="0" />
                  <GradientStop Color="{DynamicResource CardHoverColor}" Offset="1" />
                </LinearGradientBrush>
              </Button.Background>
              <StackPanel VerticalAlignment="Center" Spacing="8">
                <Border CornerRadius="12" Width="48" Height="48" HorizontalAlignment="Center">
                  <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                      <GradientStop Color="#8B5CF6" Offset="0" />
                      <GradientStop Color="#7C3AED" Offset="1" />
                    </LinearGradientBrush>
                  </Border.Background>
                  <mi:MaterialIcon Kind="HumanMaleHeight" Width="24" Height="24"
                                   Foreground="White"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <TextBlock Text="{loc:Translate CalcIdealWeight}"
                           FontSize="13" FontWeight="Bold" TextAlignment="Center"
                           Foreground="{DynamicResource TextPrimaryBrush}" />
              </StackPanel>
            </Button>

            <!-- Koerperfett -->
            <Button Grid.Row="2" Grid.Column="0"
                    CornerRadius="12" Height="120" Padding="8"
                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                    Command="{Binding OpenBodyFatCommand}">
              <Button.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                  <GradientStop Color="{DynamicResource CardColor}" Offset="0" />
                  <GradientStop Color="{DynamicResource CardHoverColor}" Offset="1" />
                </LinearGradientBrush>
              </Button.Background>
              <StackPanel VerticalAlignment="Center" Spacing="8">
                <Border CornerRadius="12" Width="48" Height="48" HorizontalAlignment="Center">
                  <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                      <GradientStop Color="#EF4444" Offset="0" />
                      <GradientStop Color="#DC2626" Offset="1" />
                    </LinearGradientBrush>
                  </Border.Background>
                  <mi:MaterialIcon Kind="PercentCircle" Width="24" Height="24"
                                   Foreground="White"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <TextBlock Text="{loc:Translate CalcBodyFat}"
                           FontSize="13" FontWeight="Bold" TextAlignment="Center"
                           Foreground="{DynamicResource TextPrimaryBrush}" />
              </StackPanel>
            </Button>

          </Grid>
        </StackPanel>

        <!-- ========== Premium-Card ========== -->
        <Button Background="Transparent" Padding="0"
                HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                IsVisible="{Binding !IsPremium}"
                Command="{Binding OpenSettingsCommand}">
          <Border CornerRadius="16" Padding="16" ClipToBounds="True">
            <Border.Background>
              <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                <GradientStop Color="{DynamicResource AccentColor}" Offset="0" />
                <GradientStop Color="{DynamicResource SecondaryColor}" Offset="1" />
              </LinearGradientBrush>
            </Border.Background>
            <Panel>
              <Ellipse Width="100" Height="100"
                       Opacity="0.1" Fill="White"
                       HorizontalAlignment="Right" VerticalAlignment="Center"
                       Margin="0,0,-20,0" />
              <Grid ColumnDefinitions="Auto,*,Auto">
                <Border Grid.Column="0" Width="44" Height="44"
                        CornerRadius="22" Background="#33FFFFFF"
                        Margin="0,0,14,0">
                  <mi:MaterialIcon Kind="Star" Width="24" Height="24"
                                   Foreground="White"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <StackPanel Grid.Column="1" VerticalAlignment="Center" Spacing="2">
                  <TextBlock Text="{Binding RemoveAdsText}"
                             FontSize="15" FontWeight="Bold" Foreground="White" />
                  <TextBlock Text="{Binding PremiumPriceText}"
                             FontSize="12" Foreground="#CCFFFFFF" />
                </StackPanel>
                <mi:MaterialIcon Grid.Column="2"
                                 Kind="ChevronRight" Width="20" Height="20"
                                 Foreground="#AAFFFFFF" VerticalAlignment="Center" />
              </Grid>
            </Panel>
          </Border>
        </Button>

        <!-- ========== Disclaimer ========== -->
        <Border Background="{DynamicResource SurfaceBrush}"
                CornerRadius="8" Padding="12"
                BoxShadow="{DynamicResource CardShadow}"
                Margin="0,4,0,0">
          <StackPanel Orientation="Horizontal" Spacing="8">
            <mi:MaterialIcon Kind="InformationOutline" Width="16" Height="16"
                             Foreground="{DynamicResource TextMutedBrush}"
                             VerticalAlignment="Top" Margin="0,2,0,0" />
            <TextBlock Text="{loc:Translate Disclaimer}"
                       FontSize="11"
                       Foreground="{DynamicResource TextMutedBrush}"
                       TextWrapping="Wrap" />
          </StackPanel>
        </Border>

      </StackPanel>
    </StackPanel>
  </ScrollViewer>

</UserControl>
