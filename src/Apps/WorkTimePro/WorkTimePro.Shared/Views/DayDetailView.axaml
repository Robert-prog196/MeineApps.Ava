<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:WorkTimePro.ViewModels"
             xmlns:models="using:WorkTimePro.Models"
             xmlns:mi="using:Material.Icons.Avalonia"
             xmlns:loc="using:MeineApps.Core.Ava.Localization"
             xmlns:controls="using:MeineApps.UI.Controls"
             x:Class="WorkTimePro.Views.DayDetailView"
             x:DataType="vm:DayDetailViewModel"
             Background="{DynamicResource BackgroundBrush}">

  <Grid RowDefinitions="Auto,*" AutomationProperties.AutomationId="DayDetail_RootGrid">

    <!-- Back Button Header -->
    <Border Grid.Row="0"
            AutomationProperties.AutomationId="DayDetail_Header"
            Background="{DynamicResource SurfaceBrush}"
            Padding="8,4">
      <StackPanel Orientation="Horizontal" Spacing="8">
        <Button AutomationProperties.AutomationId="DayDetail_BtnBack"
                Classes="Text"
                Command="{Binding GoBackCommand}">
          <mi:MaterialIcon Kind="ArrowLeft" Width="24" Height="24"
                           Foreground="{DynamicResource PrimaryBrush}" />
        </Button>
        <TextBlock AutomationProperties.AutomationId="DayDetail_TxtTitle"
                   Text="{loc:Translate DayDetails}"
                   FontSize="18" FontWeight="Bold"
                   Foreground="{DynamicResource TextPrimaryBrush}"
                   VerticalAlignment="Center" />
      </StackPanel>
    </Border>

    <!-- Content -->
    <ScrollViewer Grid.Row="1" AutomationProperties.AutomationId="DayDetail_ScrollViewer">
      <StackPanel Spacing="12" Margin="16">

        <!-- ==================== Header with Date and Status ==================== -->
        <Border Classes="CardElevated StatsCard" AutomationProperties.AutomationId="DayDetail_HeaderCard">
          <StackPanel Spacing="8">
            <TextBlock AutomationProperties.AutomationId="DayDetail_TxtDate" Text="{Binding DateDisplay}"
                       Classes="PageTitle"
                       HorizontalAlignment="Center" />

            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Center" Spacing="8">
              <mi:MaterialIcon Kind="{Binding StatusIconKind}"
                               Width="20" Height="20"
                               Foreground="{DynamicResource TextSecondaryBrush}" />
              <TextBlock AutomationProperties.AutomationId="DayDetail_TxtStatus"
                         Text="{Binding StatusDisplay}"
                         FontSize="14"
                         Foreground="{DynamicResource TextSecondaryBrush}"
                         VerticalAlignment="Center" />
              <Button AutomationProperties.AutomationId="DayDetail_BtnChangeStatus"
                      Classes="Text"
                      Command="{Binding ChangeStatusCommand}"
                      IsEnabled="{Binding !IsLocked}">
                <mi:MaterialIcon Kind="Pencil" Width="16" Height="16"
                                 Foreground="{DynamicResource PrimaryBrush}" />
              </Button>
            </StackPanel>

            <!-- Locked Badge -->
            <Border AutomationProperties.AutomationId="DayDetail_LockedBadge"
                    Background="{DynamicResource ErrorLightBrush}"
                    CornerRadius="8"
                    Padding="8,4"
                    HorizontalAlignment="Center"
                    IsVisible="{Binding IsLocked}">
              <StackPanel Orientation="Horizontal" Spacing="6">
                <mi:MaterialIcon Kind="Lock" Width="14" Height="14"
                                 Foreground="{DynamicResource ErrorBrush}" />
                <TextBlock Text="{loc:Translate LockedMonthClosure}"
                           FontSize="12"
                           Foreground="{DynamicResource ErrorBrush}" />
              </StackPanel>
            </Border>
          </StackPanel>
        </Border>

        <!-- ==================== Time Summary ==================== -->
        <Border Classes="Card StatsCard" AutomationProperties.AutomationId="DayDetail_SummaryCard">
          <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto"
                ColumnSpacing="16" RowSpacing="12">

            <!-- Work Time -->
            <StackPanel Grid.Column="0" Grid.Row="0">
              <TextBlock Text="{loc:Translate WorkTime}"
                         FontSize="12"
                         Foreground="{DynamicResource TextSecondaryBrush}" />
              <TextBlock AutomationProperties.AutomationId="DayDetail_TxtWorkTime"
                         Text="{Binding WorkTimeDisplay}"
                         FontSize="24" FontWeight="Bold"
                         Foreground="{DynamicResource TextPrimaryBrush}" />
            </StackPanel>

            <!-- Balance -->
            <StackPanel Grid.Column="1" Grid.Row="0">
              <TextBlock Text="{loc:Translate Balance}"
                         FontSize="12"
                         Foreground="{DynamicResource TextSecondaryBrush}" />
              <TextBlock AutomationProperties.AutomationId="DayDetail_TxtBalance"
                         Text="{Binding BalanceDisplay}"
                         FontSize="24" FontWeight="Bold"
                         Foreground="{Binding BalanceColor}" />
            </StackPanel>

            <!-- Manual Break -->
            <StackPanel Grid.Column="0" Grid.Row="1">
              <TextBlock Text="{loc:Translate ManualBreak}"
                         FontSize="12"
                         Foreground="{DynamicResource TextSecondaryBrush}" />
              <TextBlock AutomationProperties.AutomationId="DayDetail_TxtPauseTime"
                         Text="{Binding PauseTimeDisplay}"
                         FontSize="18"
                         Foreground="{DynamicResource WarningBrush}" />
            </StackPanel>

            <!-- Auto Break -->
            <StackPanel Grid.Column="1" Grid.Row="1">
              <StackPanel Orientation="Horizontal" Spacing="4">
                <TextBlock Text="{loc:Translate AutoPause}"
                           FontSize="12"
                           Foreground="{DynamicResource TextSecondaryBrush}" />
                <mi:MaterialIcon Kind="FlashOutline" Width="12" Height="12"
                                 Foreground="{DynamicResource WarningBrush}"
                                 IsVisible="{Binding HasAutoPause}" />
              </StackPanel>
              <TextBlock AutomationProperties.AutomationId="DayDetail_TxtAutoPause"
                         Text="{Binding AutoPauseDisplay}"
                         FontSize="18"
                         Foreground="{DynamicResource WarningBrush}"
                         Opacity="0.7" />
            </StackPanel>

          </Grid>
        </Border>

        <!-- ==================== Warnings (labor law) ==================== -->
        <Border AutomationProperties.AutomationId="DayDetail_WarningsCard"
                Background="{DynamicResource ErrorLightBrush}"
                BorderBrush="{DynamicResource ErrorBrush}"
                BorderThickness="1"
                CornerRadius="12"
                Padding="12"
                IsVisible="{Binding HasWarnings}">
          <StackPanel Spacing="8">
            <StackPanel Orientation="Horizontal" Spacing="8">
              <mi:MaterialIcon Kind="InformationOutline" Width="18" Height="18"
                               Foreground="{DynamicResource ErrorBrush}" />
              <TextBlock Text="{loc:Translate LegalWarningsTitle}"
                         FontSize="16" FontWeight="Bold"
                         Foreground="{DynamicResource ErrorBrush}" />
            </StackPanel>
            <ItemsControl ItemsSource="{Binding Warnings}">
              <ItemsControl.ItemTemplate>
                <DataTemplate x:DataType="x:String">
                  <TextBlock Text="{Binding}"
                             FontSize="12"
                             Foreground="{DynamicResource ErrorBrush}"
                             Padding="0,2" />
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </StackPanel>
        </Border>

        <!-- ==================== Time Entries (Timeline) ==================== -->
        <Border Classes="Card StatsCard" Padding="16" AutomationProperties.AutomationId="DayDetail_TimeEntriesCard">
          <StackPanel Spacing="12">
            <Grid ColumnDefinitions="*,Auto">
              <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                <mi:MaterialIcon Kind="ClockOutline" Width="20" Height="20"
                                 Foreground="{DynamicResource PrimaryBrush}" />
                <TextBlock AutomationProperties.AutomationId="DayDetail_TxtTimeEntries" Text="{loc:Translate TimeEntries}"
                           FontSize="16" FontWeight="Bold"
                           Foreground="{DynamicResource TextPrimaryBrush}"
                           VerticalAlignment="Center" />
              </StackPanel>
              <Button Grid.Column="1"
                      AutomationProperties.AutomationId="DayDetail_BtnAddEntry"
                      Content="{loc:Translate AddEntry}"
                      Classes="Primary Small"
                      Command="{Binding AddEntryCommand}"
                      IsEnabled="{Binding !IsLocked}" />
            </Grid>

            <ItemsControl ItemsSource="{Binding TimeEntries}">
              <ItemsControl.ItemTemplate>
                <DataTemplate x:DataType="models:TimeEntry">
                  <Border Padding="0" Margin="0" MinHeight="56">
                    <Grid ColumnDefinitions="32,*">
                      <!-- Timeline-Linie + Marker -->
                      <Panel Grid.Column="0" HorizontalAlignment="Center">
                        <!-- Vertikale Linie -->
                        <Border Width="2" Background="{DynamicResource PrimaryBrush}" Opacity="0.3"
                                VerticalAlignment="Stretch" HorizontalAlignment="Center" />
                        <!-- Kreis-Marker -->
                        <Border Width="12" Height="12" CornerRadius="6"
                                Background="{DynamicResource PrimaryBrush}"
                                HorizontalAlignment="Center" VerticalAlignment="Center" />
                      </Panel>
                      <!-- Eintrag-Card -->
                      <Border Grid.Column="1" Classes="Card" Padding="12" Margin="0,2">
                        <Grid ColumnDefinitions="Auto,*,Auto,Auto">
                          <mi:MaterialIcon Grid.Column="0" Kind="{Binding TypeIconKind}"
                                           Width="20" Height="20"
                                           Foreground="{DynamicResource PrimaryBrush}"
                                           VerticalAlignment="Center" Margin="0,0,12,0" />
                          <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="{Binding FullDisplay}" FontSize="14" FontWeight="Bold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                            <TextBlock Text="{Binding Note}" FontSize="12"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       IsVisible="{Binding HasNote}" />
                          </StackPanel>
                          <Button Grid.Column="2" Classes="Text"
                                  Command="{Binding $parent[UserControl].((vm:DayDetailViewModel)DataContext).EditEntryCommand}"
                                  CommandParameter="{Binding .}">
                            <mi:MaterialIcon Kind="Pencil" Width="16" Height="16"
                                             Foreground="{DynamicResource PrimaryBrush}" />
                          </Button>
                          <Button Grid.Column="3" Classes="Text"
                                  Command="{Binding $parent[UserControl].((vm:DayDetailViewModel)DataContext).DeleteEntryCommand}"
                                  CommandParameter="{Binding .}">
                            <mi:MaterialIcon Kind="Delete" Width="16" Height="16"
                                             Foreground="{DynamicResource ErrorBrush}" />
                          </Button>
                        </Grid>
                      </Border>
                    </Grid>
                  </Border>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Empty State -->
            <StackPanel AutomationProperties.AutomationId="DayDetail_EmptyTimeEntries"
                        IsVisible="{Binding HasNoTimeEntries}"
                        HorizontalAlignment="Center" Margin="0,16">
              <mi:MaterialIcon Kind="ClockOutline" Width="48" Height="48"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               HorizontalAlignment="Center" />
              <TextBlock Text="{loc:Translate NoEntries}"
                         FontSize="14"
                         Foreground="{DynamicResource TextSecondaryBrush}"
                         HorizontalAlignment="Center"
                         Margin="0,8,0,0" />
            </StackPanel>
          </StackPanel>
        </Border>

        <!-- ==================== Breaks (Timeline) ==================== -->
        <Border Classes="Card StatsCard" Padding="16" AutomationProperties.AutomationId="DayDetail_PausesCard">
          <StackPanel Spacing="12">
            <Grid ColumnDefinitions="*,Auto">
              <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                <mi:MaterialIcon Kind="Coffee" Width="20" Height="20"
                                 Foreground="{DynamicResource WarningBrush}" />
                <TextBlock AutomationProperties.AutomationId="DayDetail_TxtPauses" Text="{loc:Translate Pauses}"
                           FontSize="16" FontWeight="Bold"
                           Foreground="{DynamicResource TextPrimaryBrush}"
                           VerticalAlignment="Center" />
              </StackPanel>
              <Button Grid.Column="1"
                      AutomationProperties.AutomationId="DayDetail_BtnAddPause"
                      Content="{loc:Translate AddBreak}"
                      Classes="Primary Small"
                      Command="{Binding AddPauseCommand}"
                      IsEnabled="{Binding !IsLocked}" />
            </Grid>

            <ItemsControl ItemsSource="{Binding PauseEntries}">
              <ItemsControl.ItemTemplate>
                <DataTemplate x:DataType="models:PauseEntry">
                  <Border Padding="0" Margin="0" MinHeight="56">
                    <Grid ColumnDefinitions="32,*">
                      <!-- Timeline-Linie + Marker (WarningBrush) -->
                      <Panel Grid.Column="0" HorizontalAlignment="Center">
                        <Border Width="2" Background="{DynamicResource WarningBrush}" Opacity="0.3"
                                VerticalAlignment="Stretch" HorizontalAlignment="Center" />
                        <Border Width="12" Height="12" CornerRadius="6"
                                Background="{DynamicResource WarningBrush}"
                                HorizontalAlignment="Center" VerticalAlignment="Center" />
                      </Panel>
                      <!-- Eintrag-Card -->
                      <Border Grid.Column="1" Classes="Card" Padding="12" Margin="0,2">
                        <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto">
                          <mi:MaterialIcon Grid.Column="0"
                                           Kind="Coffee"
                                           Width="20" Height="20"
                                           Foreground="{DynamicResource WarningBrush}"
                                           VerticalAlignment="Center"
                                           Margin="0,0,12,0" />
                          <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                              <TextBlock Text="{Binding StartTimeDisplay}"
                                         FontSize="14" FontWeight="Bold"
                                         Foreground="{DynamicResource TextPrimaryBrush}" />
                              <TextBlock Text="&#x2013;"
                                         FontSize="14"
                                         Foreground="{DynamicResource TextSecondaryBrush}" />
                              <TextBlock Text="{Binding EndTimeDisplay}"
                                         FontSize="14" FontWeight="Bold"
                                         Foreground="{DynamicResource TextPrimaryBrush}" />
                            </StackPanel>
                            <TextBlock Text="{Binding DurationDisplay}"
                                       FontSize="12"
                                       Foreground="{DynamicResource TextSecondaryBrush}" />
                          </StackPanel>
                          <mi:MaterialIcon Grid.Column="2"
                                           Kind="FlashOutline"
                                           Width="16" Height="16"
                                           Foreground="{DynamicResource WarningBrush}"
                                           IsVisible="{Binding IsAutoPause}"
                                           VerticalAlignment="Center"
                                           Margin="4,0" />
                          <!-- Edit-Button (nur manuelle Pausen) -->
                          <Button Grid.Column="3" Classes="Text"
                                  Command="{Binding $parent[UserControl].((vm:DayDetailViewModel)DataContext).EditPauseCommand}"
                                  CommandParameter="{Binding .}"
                                  IsVisible="{Binding !IsAutoPause}">
                            <mi:MaterialIcon Kind="Pencil" Width="16" Height="16"
                                             Foreground="{DynamicResource PrimaryBrush}" />
                          </Button>
                          <Button Grid.Column="4" Classes="Text"
                                  Command="{Binding $parent[UserControl].((vm:DayDetailViewModel)DataContext).DeletePauseCommand}"
                                  CommandParameter="{Binding .}"
                                  IsVisible="{Binding !IsAutoPause}">
                            <mi:MaterialIcon Kind="Delete" Width="16" Height="16"
                                             Foreground="{DynamicResource ErrorBrush}" />
                          </Button>
                        </Grid>
                      </Border>
                    </Grid>
                  </Border>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Empty State -->
            <StackPanel AutomationProperties.AutomationId="DayDetail_EmptyPauses"
                        IsVisible="{Binding HasNoPauseEntries}"
                        HorizontalAlignment="Center" Margin="0,16">
              <mi:MaterialIcon Kind="Coffee" Width="48" Height="48"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               HorizontalAlignment="Center" />
              <TextBlock Text="{loc:Translate NoBreaksRecorded}"
                         FontSize="14"
                         Foreground="{DynamicResource TextSecondaryBrush}"
                         HorizontalAlignment="Center"
                         Margin="0,8,0,0" />
            </StackPanel>
          </StackPanel>
        </Border>

        <!-- Bottom Spacer (Ad-Banner) -->
        <Border Height="60" />

      </StackPanel>
    </ScrollViewer>

    <!-- ==================== TimeEntry Edit Overlay (Bottom-Sheet) ==================== -->
    <Border Grid.Row="0" Grid.RowSpan="2"
            AutomationProperties.AutomationId="DayDetail_TimeEntryOverlay"
            IsVisible="{Binding IsTimeEntryOverlayVisible}"
            Background="#80000000"
            ZIndex="10">
      <Border Classes="Card" Margin="0"
              VerticalAlignment="Bottom" HorizontalAlignment="Stretch"
              CornerRadius="20,20,0,0"
              Padding="24,24,24,32">
        <StackPanel Spacing="16">

          <!-- Titel -->
          <TextBlock AutomationProperties.AutomationId="DayDetail_TxtTimeEntryOverlayTitle"
                     Text="{Binding TimeEntryOverlayTitle}"
                     FontSize="20" FontWeight="Bold"
                     Foreground="{DynamicResource TextPrimaryBrush}" />

          <!-- Typ-Toggle (CheckIn / CheckOut) -->
          <StackPanel Spacing="4">
            <TextBlock Text="{loc:Translate EntryType}"
                       FontSize="13"
                       Foreground="{DynamicResource TextSecondaryBrush}" />
            <Grid ColumnDefinitions="*,*" Height="40">
              <!-- CheckIn aktiv -->
              <Button Grid.Column="0" Classes="Primary"
                      AutomationProperties.AutomationId="DayDetail_BtnCheckInActive"
                      Content="{loc:Translate CheckIn}"
                      IsVisible="{Binding EditIsCheckIn}"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                      CornerRadius="8,0,0,8" Padding="8,4"
                      Command="{Binding ToggleEntryTypeCommand}" />
              <Button Grid.Column="0" Classes="Outlined"
                      AutomationProperties.AutomationId="DayDetail_BtnCheckInInactive"
                      Content="{loc:Translate CheckIn}"
                      IsVisible="{Binding !EditIsCheckIn}"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                      CornerRadius="8,0,0,8" Padding="8,4"
                      Command="{Binding ToggleEntryTypeCommand}" />
              <!-- CheckOut aktiv -->
              <Button Grid.Column="1" Classes="Primary"
                      AutomationProperties.AutomationId="DayDetail_BtnCheckOutActive"
                      Content="{loc:Translate CheckOut}"
                      IsVisible="{Binding !EditIsCheckIn}"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                      CornerRadius="0,8,8,0" Padding="8,4"
                      Command="{Binding ToggleEntryTypeCommand}" />
              <Button Grid.Column="1" Classes="Outlined"
                      AutomationProperties.AutomationId="DayDetail_BtnCheckOutInactive"
                      Content="{loc:Translate CheckOut}"
                      IsVisible="{Binding EditIsCheckIn}"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                      CornerRadius="0,8,8,0" Padding="8,4"
                      Command="{Binding ToggleEntryTypeCommand}" />
            </Grid>
          </StackPanel>

          <!-- Zeit-Picker (Drum Wheel) -->
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="4">
            <StackPanel Spacing="2">
              <controls:WheelPicker AutomationProperties.AutomationId="DayDetail_WpEditHour" Value="{Binding EditHour}" Minimum="0" Maximum="23" FormatString="D2" />
              <TextBlock Text="{loc:Translate HoursShort}" Classes="Caption" HorizontalAlignment="Center"
                         Foreground="{DynamicResource TextSecondaryBrush}" />
            </StackPanel>
            <TextBlock Text=":" FontSize="28" FontWeight="Medium" VerticalAlignment="Center"
                       Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,16" />
            <StackPanel Spacing="2">
              <controls:WheelPicker AutomationProperties.AutomationId="DayDetail_WpEditMinute" Value="{Binding EditMinute}" Minimum="0" Maximum="59" FormatString="D2" />
              <TextBlock Text="{loc:Translate MinutesShort}" Classes="Caption" HorizontalAlignment="Center"
                         Foreground="{DynamicResource TextSecondaryBrush}" />
            </StackPanel>
          </StackPanel>

          <!-- Notiz -->
          <TextBox AutomationProperties.AutomationId="DayDetail_TxtEditNote"
                   Text="{Binding EditNote, Mode=TwoWay}"
                   Watermark="{loc:Translate NotePlaceholder}" />

          <!-- Buttons -->
          <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
            <Button AutomationProperties.AutomationId="DayDetail_BtnCancelTimeEntry"
                    Classes="Text" Content="{loc:Translate Cancel}"
                    Command="{Binding CancelTimeEntryOverlayCommand}" />
            <Button AutomationProperties.AutomationId="DayDetail_BtnSaveTimeEntry"
                    Classes="Primary" Content="{loc:Translate Save}"
                    Command="{Binding SaveTimeEntryCommand}" />
          </StackPanel>

        </StackPanel>
      </Border>
    </Border>

    <!-- ==================== PauseEntry Edit Overlay (Bottom-Sheet) ==================== -->
    <Border Grid.Row="0" Grid.RowSpan="2"
            AutomationProperties.AutomationId="DayDetail_PauseOverlay"
            IsVisible="{Binding IsPauseOverlayVisible}"
            Background="#80000000"
            ZIndex="10">
      <Border Classes="Card" Margin="0"
              VerticalAlignment="Bottom" HorizontalAlignment="Stretch"
              CornerRadius="20,20,0,0"
              Padding="24,24,24,32">
        <StackPanel Spacing="16">

          <!-- Titel -->
          <TextBlock AutomationProperties.AutomationId="DayDetail_TxtPauseOverlayTitle"
                     Text="{Binding PauseOverlayTitle}"
                     FontSize="20" FontWeight="Bold"
                     Foreground="{DynamicResource TextPrimaryBrush}" />

          <!-- Startzeit -->
          <StackPanel Spacing="4">
            <TextBlock Text="{loc:Translate StartTime}"
                       FontSize="13"
                       Foreground="{DynamicResource TextSecondaryBrush}" />
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="4">
              <StackPanel Spacing="2">
                <controls:WheelPicker AutomationProperties.AutomationId="DayDetail_WpPauseStartHour" Value="{Binding PauseStartHour}" Minimum="0" Maximum="23" FormatString="D2" />
                <TextBlock Text="{loc:Translate HoursShort}" Classes="Caption" HorizontalAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}" />
              </StackPanel>
              <TextBlock Text=":" FontSize="28" FontWeight="Medium" VerticalAlignment="Center"
                         Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,16" />
              <StackPanel Spacing="2">
                <controls:WheelPicker AutomationProperties.AutomationId="DayDetail_WpPauseStartMinute" Value="{Binding PauseStartMinute}" Minimum="0" Maximum="59" FormatString="D2" />
                <TextBlock Text="{loc:Translate MinutesShort}" Classes="Caption" HorizontalAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}" />
              </StackPanel>
            </StackPanel>
          </StackPanel>

          <!-- Endzeit -->
          <StackPanel Spacing="4">
            <TextBlock Text="{loc:Translate EndTime}"
                       FontSize="13"
                       Foreground="{DynamicResource TextSecondaryBrush}" />
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="4">
              <StackPanel Spacing="2">
                <controls:WheelPicker AutomationProperties.AutomationId="DayDetail_WpPauseEndHour" Value="{Binding PauseEndHour}" Minimum="0" Maximum="23" FormatString="D2" />
                <TextBlock Text="{loc:Translate HoursShort}" Classes="Caption" HorizontalAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}" />
              </StackPanel>
              <TextBlock Text=":" FontSize="28" FontWeight="Medium" VerticalAlignment="Center"
                         Foreground="{DynamicResource TextSecondaryBrush}" Margin="0,0,0,16" />
              <StackPanel Spacing="2">
                <controls:WheelPicker AutomationProperties.AutomationId="DayDetail_WpPauseEndMinute" Value="{Binding PauseEndMinute}" Minimum="0" Maximum="59" FormatString="D2" />
                <TextBlock Text="{loc:Translate MinutesShort}" Classes="Caption" HorizontalAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}" />
              </StackPanel>
            </StackPanel>
          </StackPanel>

          <!-- Notiz -->
          <TextBox AutomationProperties.AutomationId="DayDetail_TxtPauseNote"
                   Text="{Binding PauseNote, Mode=TwoWay}"
                   Watermark="{loc:Translate NotePlaceholder}" />

          <!-- Buttons -->
          <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
            <Button AutomationProperties.AutomationId="DayDetail_BtnCancelPause"
                    Classes="Text" Content="{loc:Translate Cancel}"
                    Command="{Binding CancelPauseOverlayCommand}" />
            <Button AutomationProperties.AutomationId="DayDetail_BtnSavePause"
                    Classes="Primary" Content="{loc:Translate Save}"
                    Command="{Binding SavePauseCommand}" />
          </StackPanel>

        </StackPanel>
      </Border>
    </Border>

    <!-- ==================== Confirm Delete Overlay ==================== -->
    <Border Grid.Row="0" Grid.RowSpan="2"
            AutomationProperties.AutomationId="DayDetail_ConfirmDeleteOverlay"
            IsVisible="{Binding IsConfirmDeleteVisible}"
            Background="#80000000"
            ZIndex="10"
            PointerPressed="OnOverlayBackgroundPressed">
      <Border Classes="Card" Margin="0"
              VerticalAlignment="Bottom" HorizontalAlignment="Stretch"
              CornerRadius="20,20,0,0"
              Padding="24,24,24,32"
              MaxWidth="400">
        <StackPanel Spacing="16">

          <!-- Titel -->
          <StackPanel Orientation="Horizontal" Spacing="8">
            <mi:MaterialIcon Kind="AlertCircleOutline" Width="24" Height="24"
                             Foreground="{DynamicResource ErrorBrush}" />
            <TextBlock Text="{loc:Translate ConfirmDelete}"
                       FontSize="20" FontWeight="Bold"
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>

          <!-- Nachricht -->
          <TextBlock AutomationProperties.AutomationId="DayDetail_TxtConfirmDeleteMessage"
                     Text="{Binding ConfirmDeleteMessage}"
                     FontSize="14"
                     Foreground="{DynamicResource TextSecondaryBrush}"
                     TextWrapping="Wrap" />

          <!-- Buttons -->
          <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
            <Button AutomationProperties.AutomationId="DayDetail_BtnCancelDelete"
                    Classes="Text" Content="{loc:Translate No}"
                    Command="{Binding CancelDeleteCommand}" />
            <Button AutomationProperties.AutomationId="DayDetail_BtnConfirmDelete"
                    Classes="Danger" Content="{loc:Translate Yes}"
                    Command="{Binding ConfirmDeleteCommand}" />
          </StackPanel>

        </StackPanel>
      </Border>
    </Border>

  </Grid>

</UserControl>
