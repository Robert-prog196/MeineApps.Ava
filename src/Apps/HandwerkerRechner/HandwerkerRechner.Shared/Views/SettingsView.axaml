<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:HandwerkerRechner.ViewModels"
             xmlns:mi="using:Material.Icons.Avalonia"
             x:Class="HandwerkerRechner.Views.SettingsView"
             x:DataType="vm:SettingsViewModel">

  <ScrollViewer VerticalScrollBarVisibility="Auto">
    <StackPanel Margin="16" Spacing="12">

      <!-- Header -->
      <TextBlock Text="{Binding SettingsTitleText}"
                 FontSize="22" FontWeight="Bold"
                 Foreground="{DynamicResource TextPrimaryBrush}"
                 Margin="0,4,0,4" />

      <!-- ==================== Theme Selection Card ==================== -->
      <Border Classes="SettingsCard">
        <StackPanel Spacing="12">
          <StackPanel Orientation="Horizontal" Spacing="12">
            <mi:MaterialIcon Kind="Palette" Width="24" Height="24"
                             Foreground="{DynamicResource PrimaryBrush}" />
            <TextBlock Text="{Binding ChooseDesignText}"
                       FontSize="16" FontWeight="Bold"
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>

          <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="8" RowSpacing="8">

            <!-- Midnight Theme -->
            <Panel Grid.Row="0" Grid.Column="0">
              <Button IsVisible="{Binding IsMidnightSelected}"
                      Command="{Binding SelectThemeCommand}"
                      CommandParameter="Midnight"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                      Padding="0" CornerRadius="10" Height="NaN"
                      Background="Transparent" BorderThickness="0">
                <Border CornerRadius="10" Padding="12"
                        Background="#1E293B"
                        BorderThickness="2" BorderBrush="#6366F1">
                  <Grid>
                    <mi:MaterialIcon Kind="CheckCircle" Width="18" Height="18"
                                     Foreground="#6366F1"
                                     HorizontalAlignment="Right" VerticalAlignment="Top"
                                     Margin="0,-2,-2,0" />
                    <StackPanel Spacing="6">
                      <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                        <Ellipse Width="20" Height="20" Fill="#6366F1" />
                        <Ellipse Width="20" Height="20" Fill="#0F172A" StrokeThickness="1" Stroke="#334155" />
                        <Ellipse Width="20" Height="20" Fill="#22D3EE" />
                      </StackPanel>
                      <TextBlock Text="{Binding ThemeMidnightName}" HorizontalAlignment="Center"
                                 FontWeight="Medium" FontSize="13" Foreground="#E2E8F0" />
                      <TextBlock Text="{Binding ThemeMidnightDesc}" HorizontalAlignment="Center"
                                 FontSize="11" Foreground="#94A3B8" />
                    </StackPanel>
                  </Grid>
                </Border>
              </Button>
              <Button IsVisible="{Binding !IsMidnightSelected}"
                      Command="{Binding SelectThemeCommand}"
                      CommandParameter="Midnight"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                      Padding="0" CornerRadius="10" Height="NaN"
                      Background="Transparent" BorderThickness="0">
                <Border CornerRadius="10" Padding="12"
                        Background="#1E293B"
                        BorderThickness="2" BorderBrush="#334155">
                  <StackPanel Spacing="6">
                    <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                      <Ellipse Width="20" Height="20" Fill="#6366F1" />
                      <Ellipse Width="20" Height="20" Fill="#0F172A" StrokeThickness="1" Stroke="#334155" />
                      <Ellipse Width="20" Height="20" Fill="#22D3EE" />
                    </StackPanel>
                    <TextBlock Text="{Binding ThemeMidnightName}" HorizontalAlignment="Center"
                               FontWeight="Medium" FontSize="13" Foreground="#E2E8F0" />
                    <TextBlock Text="{Binding ThemeMidnightDesc}" HorizontalAlignment="Center"
                               FontSize="11" Foreground="#94A3B8" />
                  </StackPanel>
                </Border>
              </Button>
            </Panel>

            <!-- Aurora Theme -->
            <Panel Grid.Row="0" Grid.Column="1">
              <Button IsVisible="{Binding IsAuroraSelected}"
                      Command="{Binding SelectThemeCommand}"
                      CommandParameter="Aurora"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                      Padding="0" CornerRadius="10" Height="NaN"
                      Background="Transparent" BorderThickness="0">
                <Border CornerRadius="10" Padding="12"
                        Background="#18181B"
                        BorderThickness="2" BorderBrush="#EC4899">
                  <Grid>
                    <mi:MaterialIcon Kind="CheckCircle" Width="18" Height="18"
                                     Foreground="#EC4899"
                                     HorizontalAlignment="Right" VerticalAlignment="Top"
                                     Margin="0,-2,-2,0" />
                    <StackPanel Spacing="6">
                      <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                        <Ellipse Width="20" Height="20" Fill="#EC4899" />
                        <Ellipse Width="20" Height="20" Fill="#18181B" StrokeThickness="1" Stroke="#3F3F46" />
                        <Ellipse Width="20" Height="20" Fill="#06B6D4" />
                      </StackPanel>
                      <TextBlock Text="{Binding ThemeAuroraName}" HorizontalAlignment="Center"
                                 FontWeight="Medium" FontSize="13" Foreground="#E4E4E7" />
                      <TextBlock Text="{Binding ThemeAuroraDesc}" HorizontalAlignment="Center"
                                 FontSize="11" Foreground="#A1A1AA" />
                    </StackPanel>
                  </Grid>
                </Border>
              </Button>
              <Button IsVisible="{Binding !IsAuroraSelected}"
                      Command="{Binding SelectThemeCommand}"
                      CommandParameter="Aurora"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                      Padding="0" CornerRadius="10" Height="NaN"
                      Background="Transparent" BorderThickness="0">
                <Border CornerRadius="10" Padding="12"
                        Background="#18181B"
                        BorderThickness="2" BorderBrush="#3F3F46">
                  <StackPanel Spacing="6">
                    <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                      <Ellipse Width="20" Height="20" Fill="#EC4899" />
                      <Ellipse Width="20" Height="20" Fill="#18181B" StrokeThickness="1" Stroke="#3F3F46" />
                      <Ellipse Width="20" Height="20" Fill="#06B6D4" />
                    </StackPanel>
                    <TextBlock Text="{Binding ThemeAuroraName}" HorizontalAlignment="Center"
                               FontWeight="Medium" FontSize="13" Foreground="#E4E4E7" />
                    <TextBlock Text="{Binding ThemeAuroraDesc}" HorizontalAlignment="Center"
                               FontSize="11" Foreground="#A1A1AA" />
                  </StackPanel>
                </Border>
              </Button>
            </Panel>

            <!-- Daylight Theme -->
            <Panel Grid.Row="1" Grid.Column="0">
              <Button IsVisible="{Binding IsDaylightSelected}"
                      Command="{Binding SelectThemeCommand}"
                      CommandParameter="Daylight"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                      Padding="0" CornerRadius="10" Height="NaN"
                      Background="Transparent" BorderThickness="0">
                <Border CornerRadius="10" Padding="12"
                        Background="#E2E8F0"
                        BorderThickness="2" BorderBrush="#2563EB">
                  <Grid>
                    <mi:MaterialIcon Kind="CheckCircle" Width="18" Height="18"
                                     Foreground="#2563EB"
                                     HorizontalAlignment="Right" VerticalAlignment="Top"
                                     Margin="0,-2,-2,0" />
                    <StackPanel Spacing="6">
                      <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                        <Ellipse Width="20" Height="20" Fill="#2563EB" />
                        <Ellipse Width="20" Height="20" Fill="#F8FAFC" StrokeThickness="1" Stroke="#CBD5E1" />
                        <Ellipse Width="20" Height="20" Fill="#0891B2" />
                      </StackPanel>
                      <TextBlock Text="{Binding ThemeDaylightName}" HorizontalAlignment="Center"
                                 FontWeight="Medium" FontSize="13" Foreground="#1E293B" />
                      <TextBlock Text="{Binding ThemeDaylightDesc}" HorizontalAlignment="Center"
                                 FontSize="11" Foreground="#64748B" />
                    </StackPanel>
                  </Grid>
                </Border>
              </Button>
              <Button IsVisible="{Binding !IsDaylightSelected}"
                      Command="{Binding SelectThemeCommand}"
                      CommandParameter="Daylight"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                      Padding="0" CornerRadius="10" Height="NaN"
                      Background="Transparent" BorderThickness="0">
                <Border CornerRadius="10" Padding="12"
                        Background="#E2E8F0"
                        BorderThickness="2" BorderBrush="#CBD5E1">
                  <StackPanel Spacing="6">
                    <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                      <Ellipse Width="20" Height="20" Fill="#2563EB" />
                      <Ellipse Width="20" Height="20" Fill="#F8FAFC" StrokeThickness="1" Stroke="#CBD5E1" />
                      <Ellipse Width="20" Height="20" Fill="#0891B2" />
                    </StackPanel>
                    <TextBlock Text="{Binding ThemeDaylightName}" HorizontalAlignment="Center"
                               FontWeight="Medium" FontSize="13" Foreground="#1E293B" />
                    <TextBlock Text="{Binding ThemeDaylightDesc}" HorizontalAlignment="Center"
                               FontSize="11" Foreground="#64748B" />
                  </StackPanel>
                </Border>
              </Button>
            </Panel>

            <!-- Forest Theme -->
            <Panel Grid.Row="1" Grid.Column="1">
              <Button IsVisible="{Binding IsForestSelected}"
                      Command="{Binding SelectThemeCommand}"
                      CommandParameter="Forest"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                      Padding="0" CornerRadius="10" Height="NaN"
                      Background="Transparent" BorderThickness="0">
                <Border CornerRadius="10" Padding="12"
                        Background="#022C22"
                        BorderThickness="2" BorderBrush="#10B981">
                  <Grid>
                    <mi:MaterialIcon Kind="CheckCircle" Width="18" Height="18"
                                     Foreground="#10B981"
                                     HorizontalAlignment="Right" VerticalAlignment="Top"
                                     Margin="0,-2,-2,0" />
                    <StackPanel Spacing="6">
                      <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                        <Ellipse Width="20" Height="20" Fill="#10B981" />
                        <Ellipse Width="20" Height="20" Fill="#022C22" StrokeThickness="1" Stroke="#065F46" />
                        <Ellipse Width="20" Height="20" Fill="#F59E0B" />
                      </StackPanel>
                      <TextBlock Text="{Binding ThemeForestName}" HorizontalAlignment="Center"
                                 FontWeight="Medium" FontSize="13" Foreground="#D1FAE5" />
                      <TextBlock Text="{Binding ThemeForestDesc}" HorizontalAlignment="Center"
                                 FontSize="11" Foreground="#6EE7B7" />
                    </StackPanel>
                  </Grid>
                </Border>
              </Button>
              <Button IsVisible="{Binding !IsForestSelected}"
                      Command="{Binding SelectThemeCommand}"
                      CommandParameter="Forest"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
                      Padding="0" CornerRadius="10" Height="NaN"
                      Background="Transparent" BorderThickness="0">
                <Border CornerRadius="10" Padding="12"
                        Background="#022C22"
                        BorderThickness="2" BorderBrush="#065F46">
                  <StackPanel Spacing="6">
                    <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Center">
                      <Ellipse Width="20" Height="20" Fill="#10B981" />
                      <Ellipse Width="20" Height="20" Fill="#022C22" StrokeThickness="1" Stroke="#065F46" />
                      <Ellipse Width="20" Height="20" Fill="#F59E0B" />
                    </StackPanel>
                    <TextBlock Text="{Binding ThemeForestName}" HorizontalAlignment="Center"
                               FontWeight="Medium" FontSize="13" Foreground="#D1FAE5" />
                    <TextBlock Text="{Binding ThemeForestDesc}" HorizontalAlignment="Center"
                               FontSize="11" Foreground="#6EE7B7" />
                  </StackPanel>
                </Border>
              </Button>
            </Panel>

          </Grid>
        </StackPanel>
      </Border>

      <!-- ==================== Language Selection Card ==================== -->
      <Border Classes="SettingsCard">
        <StackPanel Spacing="12">
          <StackPanel Orientation="Horizontal" Spacing="12">
            <mi:MaterialIcon Kind="Translate" Width="24" Height="24"
                             Foreground="{DynamicResource PrimaryBrush}" />
            <TextBlock Text="{Binding LanguageTitleText}"
                       FontSize="16" FontWeight="Bold"
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>

          <WrapPanel Orientation="Horizontal">
            <!-- Deutsch -->
            <Panel>
              <Button Classes="Primary Small" Content="Deutsch"
                      IsVisible="{Binding IsGermanSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="de"
                      Margin="0,0,8,8" />
              <Button Classes="Outlined Small" Content="Deutsch"
                      IsVisible="{Binding !IsGermanSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="de"
                      Margin="0,0,8,8" />
            </Panel>

            <!-- English -->
            <Panel>
              <Button Classes="Primary Small" Content="English"
                      IsVisible="{Binding IsEnglishSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="en"
                      Margin="0,0,8,8" />
              <Button Classes="Outlined Small" Content="English"
                      IsVisible="{Binding !IsEnglishSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="en"
                      Margin="0,0,8,8" />
            </Panel>

            <!-- Espanol -->
            <Panel>
              <Button Classes="Primary Small" Content="Espa&#241;ol"
                      IsVisible="{Binding IsSpanishSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="es"
                      Margin="0,0,8,8" />
              <Button Classes="Outlined Small" Content="Espa&#241;ol"
                      IsVisible="{Binding !IsSpanishSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="es"
                      Margin="0,0,8,8" />
            </Panel>

            <!-- Francais -->
            <Panel>
              <Button Classes="Primary Small" Content="Fran&#231;ais"
                      IsVisible="{Binding IsFrenchSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="fr"
                      Margin="0,0,8,8" />
              <Button Classes="Outlined Small" Content="Fran&#231;ais"
                      IsVisible="{Binding !IsFrenchSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="fr"
                      Margin="0,0,8,8" />
            </Panel>

            <!-- Italiano -->
            <Panel>
              <Button Classes="Primary Small" Content="Italiano"
                      IsVisible="{Binding IsItalianSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="it"
                      Margin="0,0,8,8" />
              <Button Classes="Outlined Small" Content="Italiano"
                      IsVisible="{Binding !IsItalianSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="it"
                      Margin="0,0,8,8" />
            </Panel>

            <!-- Portugues -->
            <Panel>
              <Button Classes="Primary Small" Content="Portugu&#234;s"
                      IsVisible="{Binding IsPortugueseSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="pt"
                      Margin="0,0,8,8" />
              <Button Classes="Outlined Small" Content="Portugu&#234;s"
                      IsVisible="{Binding !IsPortugueseSelected}"
                      Command="{Binding SelectLanguageCommand}" CommandParameter="pt"
                      Margin="0,0,8,8" />
            </Panel>
          </WrapPanel>
        </StackPanel>
      </Border>

      <!-- ==================== Unit System Card ==================== -->
      <Border Classes="SettingsCard">
        <StackPanel Spacing="12">
          <StackPanel Orientation="Horizontal" Spacing="12">
            <mi:MaterialIcon Kind="Ruler" Width="24" Height="24"
                             Foreground="{DynamicResource PrimaryBrush}" />
            <TextBlock Text="{Binding UnitSystemTitleText}"
                       FontSize="16" FontWeight="Bold"
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>

          <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
            <!-- Metric -->
            <Panel Grid.Column="0">
              <Button Classes="Primary"
                      IsVisible="{Binding IsMetricSelected}"
                      Command="{Binding SelectUnitSystemCommand}" CommandParameter="Metric"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                      CornerRadius="8">
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <mi:MaterialIcon Kind="CheckCircle" Width="16" Height="16" />
                  <TextBlock Text="{Binding MetricText}" VerticalAlignment="Center" />
                </StackPanel>
              </Button>
              <Button Classes="Outlined"
                      IsVisible="{Binding !IsMetricSelected}"
                      Command="{Binding SelectUnitSystemCommand}" CommandParameter="Metric"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                      CornerRadius="8">
                <TextBlock Text="{Binding MetricText}" />
              </Button>
            </Panel>

            <!-- Imperial -->
            <Panel Grid.Column="1">
              <Button Classes="Primary"
                      IsVisible="{Binding IsImperialSelected}"
                      Command="{Binding SelectUnitSystemCommand}" CommandParameter="Imperial"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                      CornerRadius="8">
                <StackPanel Orientation="Horizontal" Spacing="6">
                  <mi:MaterialIcon Kind="CheckCircle" Width="16" Height="16" />
                  <TextBlock Text="{Binding ImperialText}" VerticalAlignment="Center" />
                </StackPanel>
              </Button>
              <Button Classes="Outlined"
                      IsVisible="{Binding !IsImperialSelected}"
                      Command="{Binding SelectUnitSystemCommand}" CommandParameter="Imperial"
                      HorizontalAlignment="Stretch" HorizontalContentAlignment="Center"
                      CornerRadius="8">
                <TextBlock Text="{Binding ImperialText}" />
              </Button>
            </Panel>
          </Grid>
        </StackPanel>
      </Border>

      <!-- ==================== Premium Section (mit Shimmer) ==================== -->
      <Border Classes="SettingsCard PremiumShimmer"
              IsVisible="{Binding ShowPurchaseSection}">
        <StackPanel Spacing="12">
          <StackPanel Orientation="Horizontal" Spacing="12">
            <mi:MaterialIcon Kind="Crown" Width="24" Height="24"
                             Foreground="{DynamicResource PrimaryBrush}" />
            <TextBlock Text="{Binding PremiumTitleText}"
                       FontSize="16" FontWeight="Bold"
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>

          <TextBlock Text="{Binding RemoveAdsDescText}"
                     FontSize="14"
                     Foreground="{DynamicResource TextSecondaryBrush}" />

          <Button Content="{Binding RemoveAdsText}"
                  Command="{Binding PurchaseRemoveAdsCommand}"
                  Classes="Primary"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"
                  CornerRadius="8" />

          <Button Content="{Binding RestorePurchasesText}"
                  Command="{Binding RestorePurchasesCommand}"
                  Classes="Secondary"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"
                  CornerRadius="8" />
        </StackPanel>
      </Border>

      <!-- Ad-Free Confirmation -->
      <Border Classes="SettingsCard"
              IsVisible="{Binding ShowAdFreeInfo}">
        <StackPanel Spacing="12">
          <StackPanel Orientation="Horizontal" Spacing="12">
            <mi:MaterialIcon Kind="CheckCircle" Width="24" Height="24"
                             Foreground="{DynamicResource AccentBrush}" />
            <TextBlock Text="{Binding AdFreeTitleText}"
                       FontSize="16" FontWeight="Bold"
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>
          <TextBlock Text="{Binding AdFreeConfirmationText}"
                     FontSize="14"
                     Foreground="{DynamicResource TextSecondaryBrush}" />
        </StackPanel>
      </Border>

      <!-- ==================== About Section ==================== -->
      <Border Classes="SettingsCard">
        <StackPanel Spacing="12">
          <StackPanel Orientation="Horizontal" Spacing="12">
            <mi:MaterialIcon Kind="InformationOutline" Width="24" Height="24"
                             Foreground="{DynamicResource PrimaryBrush}" />
            <TextBlock Text="{Binding AboutTitleText}"
                       FontSize="16" FontWeight="Bold"
                       Foreground="{DynamicResource TextPrimaryBrush}"
                       VerticalAlignment="Center" />
          </StackPanel>

          <TextBlock Text="HandwerkerRechner" FontSize="16" FontWeight="Bold"
                     Foreground="{DynamicResource TextPrimaryBrush}" />
          <TextBlock Text="{Binding AppVersion}"
                     FontSize="14"
                     Foreground="{DynamicResource TextSecondaryBrush}" />

          <Button Command="{Binding SendFeedbackCommand}"
                  Classes="Outlined"
                  HorizontalAlignment="Stretch"
                  HorizontalContentAlignment="Center"
                  CornerRadius="8">
            <StackPanel Orientation="Horizontal" Spacing="8">
              <mi:MaterialIcon Kind="EmailOutline" Width="18" Height="18"
                               Foreground="{DynamicResource TextSecondaryBrush}" />
              <TextBlock Text="{Binding SendFeedbackText}" VerticalAlignment="Center" />
            </StackPanel>
          </Button>
        </StackPanel>
      </Border>

      <!-- Bottom Spacer -->
      <Border Height="60" />

    </StackPanel>
  </ScrollViewer>

</UserControl>
