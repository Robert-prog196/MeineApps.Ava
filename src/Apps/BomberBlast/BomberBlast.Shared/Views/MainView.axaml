<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:BomberBlast.ViewModels"
             xmlns:views="using:BomberBlast.Views"
             xmlns:loc="using:MeineApps.Core.Ava.Localization"
             xmlns:controls="using:MeineApps.UI.Controls"
             x:Class="BomberBlast.Views.MainView"
             x:DataType="vm:MainViewModel">

  <Panel>
    <!-- Main Menu -->
    <views:MainMenuView DataContext="{Binding MenuVm}"
                         IsVisible="{Binding $parent[views:MainView].((vm:MainViewModel)DataContext).IsMainMenuActive}" />

    <!-- Game -->
    <views:GameView DataContext="{Binding GameVm}"
                     IsVisible="{Binding $parent[views:MainView].((vm:MainViewModel)DataContext).IsGameActive}" />

    <!-- Level Select -->
    <views:LevelSelectView DataContext="{Binding LevelSelectVm}"
                            IsVisible="{Binding $parent[views:MainView].((vm:MainViewModel)DataContext).IsLevelSelectActive}" />

    <!-- Settings -->
    <views:SettingsView DataContext="{Binding SettingsVm}"
                         IsVisible="{Binding $parent[views:MainView].((vm:MainViewModel)DataContext).IsSettingsActive}" />

    <!-- High Scores -->
    <views:HighScoresView DataContext="{Binding HighScoresVm}"
                           IsVisible="{Binding $parent[views:MainView].((vm:MainViewModel)DataContext).IsHighScoresActive}" />

    <!-- Game Over -->
    <views:GameOverView DataContext="{Binding GameOverVm}"
                         IsVisible="{Binding $parent[views:MainView].((vm:MainViewModel)DataContext).IsGameOverActive}" />

    <!-- Help -->
    <views:HelpView DataContext="{Binding HelpVm}"
                     IsVisible="{Binding $parent[views:MainView].((vm:MainViewModel)DataContext).IsHelpActive}" />

    <!-- Shop -->
    <views:ShopView DataContext="{Binding ShopVm}"
                     IsVisible="{Binding $parent[views:MainView].((vm:MainViewModel)DataContext).IsShopActive}" />

    <!-- Alert Dialog Overlay -->
    <Border IsVisible="{Binding IsAlertDialogVisible}"
            Background="#80000000" ZIndex="100"
            HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
      <Border Background="{DynamicResource SurfaceBrush}"
              CornerRadius="16" Padding="24" MaxWidth="360"
              HorizontalAlignment="Center" VerticalAlignment="Center"
              BoxShadow="0 8 24 0 #40000000">
        <StackPanel Spacing="16">
          <TextBlock Text="{Binding AlertDialogTitle}"
                     Classes="TitleMedium"
                     Foreground="{DynamicResource TextPrimaryBrush}" />
          <TextBlock Text="{Binding AlertDialogMessage}"
                     TextWrapping="Wrap"
                     Foreground="{DynamicResource TextSecondaryBrush}" />
          <Button Classes="Primary" HorizontalAlignment="Right"
                  Content="{Binding AlertDialogButtonText}"
                  Command="{Binding DismissAlertCommand}" />
        </StackPanel>
      </Border>
    </Border>

    <!-- Confirm Dialog Overlay -->
    <Border IsVisible="{Binding IsConfirmDialogVisible}"
            Background="#80000000" ZIndex="100"
            HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
      <Border Background="{DynamicResource SurfaceBrush}"
              CornerRadius="16" Padding="24" MaxWidth="360"
              HorizontalAlignment="Center" VerticalAlignment="Center"
              BoxShadow="0 8 24 0 #40000000">
        <StackPanel Spacing="16">
          <TextBlock Text="{Binding ConfirmDialogTitle}"
                     Classes="TitleMedium"
                     Foreground="{DynamicResource TextPrimaryBrush}" />
          <TextBlock Text="{Binding ConfirmDialogMessage}"
                     TextWrapping="Wrap"
                     Foreground="{DynamicResource TextSecondaryBrush}" />
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8">
            <Button Classes="Secondary"
                    Content="{Binding ConfirmDialogCancelText}"
                    Command="{Binding CancelConfirmCommand}" />
            <Button Classes="Danger"
                    Content="{Binding ConfirmDialogAcceptText}"
                    Command="{Binding AcceptConfirmCommand}" />
          </StackPanel>
        </StackPanel>
      </Border>
    </Border>

    <!-- Game Juice Overlays -->
    <controls:FloatingTextOverlay x:Name="FloatingTextCanvas"
                                   ZIndex="15"
                                   IsHitTestVisible="False" />
    <controls:CelebrationOverlay x:Name="CelebrationCanvas"
                                  ZIndex="16"
                                  IsHitTestVisible="False" />
  </Panel>

</UserControl>
